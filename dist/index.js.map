{"version":3,"file":"index.js","sources":["../src/DocViewerPlus.tsx"],"sourcesContent":["import { CloseOutlined, DownloadOutlined } from '@ant-design/icons';\nimport { Image } from 'antd';\nimport React from 'react';\n\nexport interface DocViewerPlusProps {\n  previewFile?: {\n    fileUrl?: string;\n    fileName?: string;\n  };\n  response?: {\n    url?: string;\n  };\n  visibleViewerPlus: boolean;\n  onVisibleChange: () => void;\n}\n\nexport const DocViewerPlus: React.FC<DocViewerPlusProps> = ({\n  previewFile,\n  response,\n  visibleViewerPlus,\n  onVisibleChange,\n}) => {\n  const fileUrl = previewFile?.fileUrl || '';\n  const fileName = previewFile?.fileName || '';\n  const isBase64 = (str: string) => {\n    return /^data:[^;]+;base64,/i.test(str);\n  };\n\n  const ext = isBase64(fileUrl) ? 'jpg' : fileUrl.split('.').pop()?.toLowerCase() || '';\n  const fileType = ['jpg', 'jpeg', 'png', 'gif'].includes(ext)\n    ? 'image'\n    : ext === 'pdf'\n    ? 'pdf'\n    : ['doc', 'docx', 'xls', 'xlsx', 'ppt', 'pptx'].includes(ext)\n    ? 'office'\n    : ext === 'ofd'\n    ? 'ofd'\n    : ext === 'mp4'\n    ? 'video'\n    : 'unknown';\n\n  const handleDownload = () => {\n    const link = document.createElement('a');\n    link.href = response?.url || fileUrl;\n    link.download = fileName || 'download';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n\n  if ((fileType === 'unknown' || !fileUrl) && visibleViewerPlus) {\n    handleDownload();\n    return null;\n  }\n\n  const overlayStyle: React.CSSProperties = {\n    position: 'fixed',\n    top: 0,\n    left: 0,\n    width: '100%',\n    height: '100%',\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    zIndex: 9999,\n    padding: 20,\n    boxSizing: 'border-box',\n  };\n\n  const containerStyle: React.CSSProperties = {\n    position: 'relative',\n    width: '80%',\n    maxWidth: '1200px',\n  };\n\n  const headerStyle: React.CSSProperties = {\n    display: 'flex',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    padding: 10,\n    borderBottom: '1px solid #ddd',\n    backgroundColor: '#f5f5f5',\n  };\n\n  const titleStyle: React.CSSProperties = {\n    flexGrow: 1,\n    textAlign: 'center',\n    whiteSpace: 'nowrap',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    width: '70%',\n  };\n\n  const iconContainerStyle: React.CSSProperties = {\n    display: 'flex',\n    alignItems: 'center',\n  };\n\n  const iconStyle: React.CSSProperties = {\n    fontSize: '20px',\n    cursor: 'pointer',\n    marginLeft: '10px',\n  };\n\n  return visibleViewerPlus ? (\n    <>\n      {fileType === 'image' ? (\n        <Image\n          alt=\"preview\"\n          style={{ width: '100%', display: 'none' }}\n          src={fileUrl}\n          preview={{\n            visible: true,\n            onVisibleChange: onVisibleChange,\n          }}\n        />\n      ) : (\n        <div style={overlayStyle} onClick={onVisibleChange}>\n          <div style={containerStyle} onClick={(e) => e.stopPropagation()}>\n            <div style={headerStyle}>\n              <div style={titleStyle}>{fileName}</div>\n              <div style={iconContainerStyle}>\n                {fileType === 'office' && (\n                  <DownloadOutlined onClick={handleDownload} style={iconStyle} />\n                )}\n                <CloseOutlined onClick={onVisibleChange} style={iconStyle} />\n              </div>\n            </div>\n            {fileType === 'video' ? (\n              <video controls width=\"100%\" height=\"700px\">\n                <source src={fileUrl} type=\"video/mp4\" />\n                Your browser does not support the video tag.\n              </video>\n            ) : fileType === 'ofd' ? (\n              <iframe\n                src={`https://ofd.xdocin.com/view?src=${encodeURIComponent(fileUrl)}`}\n                title=\"OFD 文档预览\"\n                width=\"100%\"\n                height=\"700px\"\n                style={{ border: 'none' }}\n              />\n            ) : (\n              <iframe\n                src={\n                  fileType === 'office'\n                    ? `https://view.officeapps.live.com/op/embed.aspx?src=${encodeURIComponent(\n                        fileUrl,\n                      )}`\n                    : fileUrl\n                }\n                title=\"文档预览\"\n                width=\"100%\"\n                height=\"700px\"\n                style={{ border: 'none' }}\n              />\n            )}\n          </div>\n        </div>\n      )}\n    </>\n  ) : null;\n};\n"],"names":["React","Image","DownloadOutlined","CloseOutlined"],"mappings":"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"}